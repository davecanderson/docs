import{_ as a,o as t,c as e,d as n,b as s,a as p}from"./app.2aea72c0.js";const P='{"title":"gRPC protoc Flutter Dart Client","description":"","frontmatter":{"slug":"grpc-flutter","title":"gRPC protoc Flutter Dart Client"},"headers":[{"level":2,"title":"Flutter protoc generated GrpcServiceClient Example","slug":"flutter-protoc-generated-grpcserviceclient-example"},{"level":3,"title":"Flutter protoc gRPC insecure Example","slug":"flutter-protoc-grpc-insecure-example"},{"level":3,"title":"Flutter protoc gRPC SSL Example","slug":"flutter-protoc-grpc-ssl-example"}],"relativePath":"grpc-flutter.md"}',o={},c=n("p",null,[n("a",{href:"https://youtu.be/t83gDzEGpac",target:"_blank",rel:"noopener noreferrer"},[n("img",{src:"https://raw.githubusercontent.com/NetCoreApps/todo-world/master/src/TodoWorld/wwwroot/assets/img/flutter/flutter-grpc-ssl.png",alt:""})])],-1),l=n("iframe",{class:"video-hd",src:"https://www.youtube.com/embed/UQlYodNS1xc",frameborder:"0",allow:"autoplay; encrypted-media",allowfullscreen:""},null,-1),u=n("h2",{id:"flutter-protoc-generated-grpcserviceclient-example",tabindex:"-1"},[s("Flutter protoc generated GrpcServiceClient Example "),n("a",{class:"header-anchor",href:"#flutter-protoc-generated-grpcserviceclient-example","aria-hidden":"true"},"#")],-1),i=n("p",null,[s("Install "),n("a",{href:"https://docs.servicestack.net/dotnet-tool",target:"_blank",rel:"noopener noreferrer"},"x dotnet tool"),s(":")],-1),r=n("div",{class:"sh-copy cp flex cursor-pointer mb-3",onclick:"copy(this)"},[n("div",{class:"flex-grow bg-gray-800"},[n("div",{class:"pl-4 py-1 pb-1.5 align-middle whitespace-pre text-base text-gray-100"},[n("p",null,"dotnet tool install --global x")])]),n("div",{class:"flex"},[n("div",{class:"bg-green-600 text-white p-1.5 pb-0"},[n("svg",{class:"copied w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})]),n("svg",{class:"nocopy w-6 h-6",title:"copy",fill:"none",stroke:"white",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1",d:"M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2"})])])])],-1),k=n("p",null,[s("Create a new Flutter project with "),n("a",{href:"https://developer.android.com/studio",target:"_blank",rel:"noopener noreferrer"},"Android Studio"),s(":")],-1),d=n("p",null,[n("img",{src:"https://raw.githubusercontent.com/NetCoreApps/todo-world/master/src/TodoWorld/wwwroot/assets/img/flutter/new-flutter-project.png",alt:""})],-1),g=n("p",null,[s("Add protoc generated TodoWorld DTOs and gRPC GrpcServiceClient to "),n("code",null,"lib/"),s(" folder:")],-1),m=n("div",{class:"sh-copy cp flex cursor-pointer mb-3",onclick:"copy(this)"},[n("div",{class:"flex-grow bg-gray-800"},[n("div",{class:"pl-4 py-1 pb-1.5 align-middle whitespace-pre text-base text-gray-100"},[n("p",null,[s("x proto-dart "),n("a",{href:"https://todoworld.servicestack.net",target:"_blank",rel:"noopener noreferrer"},"https://todoworld.servicestack.net"),s(" -out lib")])])]),n("div",{class:"flex"},[n("div",{class:"bg-green-600 text-white p-1.5 pb-0"},[n("svg",{class:"copied w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})]),n("svg",{class:"nocopy w-6 h-6",title:"copy",fill:"none",stroke:"white",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1",d:"M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2"})])])])],-1),h=p(`<p>Add required dependencies to <strong>pubspec.yaml</strong>:</p><div class="language-yaml"><pre><code><span class="token key atrule">dependencies</span><span class="token punctuation">:</span>
  <span class="token key atrule">fixnum</span><span class="token punctuation">:</span> ^0.10.11
  <span class="token key atrule">async</span><span class="token punctuation">:</span> ^2.2.0
  <span class="token key atrule">protobuf</span><span class="token punctuation">:</span> ^1.0.1
  <span class="token key atrule">grpc</span><span class="token punctuation">:</span> ^2.1.3
</code></pre></div><p>Install dependencies by running <code>pub get</code> or clicking on <strong>Get Dependencies</strong> link in the IDE:</p><p><img src="https://raw.githubusercontent.com/NetCoreApps/todo-world/master/src/TodoWorld/wwwroot/assets/img/flutter/pub-get.png" alt=""></p><h3 id="flutter-protoc-grpc-insecure-example" tabindex="-1">Flutter protoc gRPC insecure Example <a class="header-anchor" href="#flutter-protoc-grpc-insecure-example" aria-hidden="true">#</a></h3><p>Use protoc generated DTOs and <code>GrpcServiceClient</code> to call TodoWorld gRPC Service in <code>_MyHomePageState</code> class in <code>bin/main.dart</code>:</p><div class="language-dart"><pre><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">&#39;package:flutter/material.dart&#39;</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">&#39;package:flutter_grpc/services.pbgrpc.dart&#39;</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">&#39;package:grpc/grpc.dart&#39;</span></span><span class="token punctuation">;</span>

<span class="token comment">//...</span>

<span class="token keyword">class</span> _MyHomePageState <span class="token keyword">extends</span> <span class="token class-name">State</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MyHomePage</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
  <span class="token class-name">String</span> result <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&#39;&#39;</span></span><span class="token punctuation">;</span>
  <span class="token class-name">GrpcServicesClient</span> client <span class="token operator">=</span> <span class="token class-name">GrpcServicesClient</span><span class="token punctuation">(</span>
      <span class="token class-name">ClientChannel</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;todoworld.servicestack.net&#39;</span></span><span class="token punctuation">,</span> port<span class="token punctuation">:</span><span class="token number">50054</span><span class="token punctuation">,</span>
          options<span class="token punctuation">:</span><span class="token class-name">ChannelOptions</span><span class="token punctuation">(</span>credentials<span class="token punctuation">:</span> <span class="token class-name">ChannelCredentials</span><span class="token punctuation">.</span><span class="token function">insecure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">void</span> <span class="token function">_callGrpcService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> response <span class="token operator">=</span> <span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">getHello</span><span class="token punctuation">(</span><span class="token class-name">Hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string-literal"><span class="token string">&quot;Flutter gRPC&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      result <span class="token operator">=</span> response<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">//...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Capture the result gRPC API request in the <code>result</code> String then change the Widget <code>build()</code> to display that instead of <code>_counter</code> then update the <code>floatingActionButton</code> to call your <code>_callGrpcService</code> method instead:</p><div class="language-dart"><pre><code>  <span class="token metadata function">@override</span>
  <span class="token class-name">Widget</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">Scaffold</span><span class="token punctuation">(</span>
      appBar<span class="token punctuation">:</span> <span class="token class-name">AppBar</span><span class="token punctuation">(</span>
        title<span class="token punctuation">:</span> <span class="token class-name">Text</span><span class="token punctuation">(</span>widget<span class="token punctuation">.</span>title<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
      body<span class="token punctuation">:</span> <span class="token class-name">Center</span><span class="token punctuation">(</span>
        child<span class="token punctuation">:</span> <span class="token class-name">Column</span><span class="token punctuation">(</span>
          mainAxisAlignment<span class="token punctuation">:</span> <span class="token class-name">MainAxisAlignment</span><span class="token punctuation">.</span>center<span class="token punctuation">,</span>
          children<span class="token punctuation">:</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Widget</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span>
            <span class="token class-name">Text</span><span class="token punctuation">(</span>
              <span class="token string-literal"><span class="token string">&#39;gRPC Service Example:&#39;</span></span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token class-name">Text</span><span class="token punctuation">(</span>
              <span class="token string-literal"><span class="token string">&#39;</span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">result</span></span><span class="token string">&#39;</span></span><span class="token punctuation">,</span>
              style<span class="token punctuation">:</span> <span class="token class-name">Theme</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">.</span>textTheme<span class="token punctuation">.</span>display1<span class="token punctuation">,</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
      floatingActionButton<span class="token punctuation">:</span> <span class="token class-name">FloatingActionButton</span><span class="token punctuation">(</span>
        onPressed<span class="token punctuation">:</span> _callGrpcService<span class="token punctuation">,</span>
        tooltip<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&#39;gRPC Service Example&#39;</span></span><span class="token punctuation">,</span>
        child<span class="token punctuation">:</span> <span class="token class-name">Icon</span><span class="token punctuation">(</span><span class="token class-name">Icons</span><span class="token punctuation">.</span>play_arrow<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>With Flutter&#39;s live-reload capability you should be able to see your changes instantly in the Android emulator where clicking the icon should display the result of your plain-text gRPC Service Request:</p><p><img src="https://raw.githubusercontent.com/NetCoreApps/todo-world/master/src/TodoWorld/wwwroot/assets/img/flutter/flutter-grpc-insecure.png" alt=""></p><h3 id="flutter-protoc-grpc-ssl-example" tabindex="-1">Flutter protoc gRPC SSL Example <a class="header-anchor" href="#flutter-protoc-grpc-ssl-example" aria-hidden="true">#</a></h3><p>To use gRPC SSL we&#39;ll need a copy of our gRPC&#39;s Service SSL Certificate which we can make available to our Flutter App by saving it to our App&#39;s <code>assets</code> directory:</p><div class="language-bash"><pre><code><span class="token function">mkdir</span> assets
x get https://todoworld.servicestack.net/grpc.crt <span class="token parameter variable">-out</span> assets
</code></pre></div><p>As loading assets is an asynchronous operation we&#39;ll need to preload it either by loading it in <code>main()</code> and passing it as an attribute down to all our components or we can load it in our State widget&#39;s <code>initState()</code> method:</p><div class="language-dart"><pre><code><span class="token keyword">class</span> _MyHomePageState <span class="token keyword">extends</span> <span class="token class-name">State</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MyHomePage</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
  <span class="token class-name">String</span> result <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&#39;&#39;</span></span><span class="token punctuation">;</span>
  <span class="token class-name">GrpcServicesClient</span> client<span class="token punctuation">;</span>

  <span class="token metadata function">@override</span>
  <span class="token keyword">void</span> <span class="token function">initState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">initState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">DefaultAssetBundle</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;assets/grpc.crt&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      client <span class="token operator">=</span> <span class="token class-name">GrpcServicesClient</span><span class="token punctuation">(</span>
          <span class="token class-name">ClientChannel</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;todoworld.servicestack.net&#39;</span></span><span class="token punctuation">,</span> port<span class="token punctuation">:</span><span class="token number">50051</span><span class="token punctuation">,</span>
              options<span class="token punctuation">:</span><span class="token class-name">ChannelOptions</span><span class="token punctuation">(</span>credentials<span class="token punctuation">:</span> <span class="token class-name">ChannelCredentials</span><span class="token punctuation">.</span><span class="token function">secure</span><span class="token punctuation">(</span>
                  certificates<span class="token punctuation">:</span> bytes<span class="token punctuation">.</span>buffer<span class="token punctuation">.</span><span class="token function">asUint8List</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                  authority<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&#39;todoworld.servicestack.net&#39;</span></span>
              <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">void</span> <span class="token function">_callGrpcService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> response <span class="token operator">=</span> <span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">getHello</span><span class="token punctuation">(</span><span class="token class-name">Hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string-literal"><span class="token string">&quot;gRPC SSL&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      result <span class="token operator">=</span> response<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">//...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>You&#39;ll also need to update the port to refer to the gRPC SSL endpoint, update your <code>Hello</code> request so we can verify the result is from the new gRPC SSL request. Now after live-reload has completed, clicking on the icon will show the response of a gRPC SSL Request:</p><p><img src="https://raw.githubusercontent.com/NetCoreApps/todo-world/master/src/TodoWorld/wwwroot/assets/img/flutter/flutter-grpc-ssl.png" alt=""></p><p>Refer to <a href="https://github.com/NetCoreApps/todo-world/tree/master/src/mobile/flutter/flutter_grpc" target="_blank" rel="noopener noreferrer">/src/mobile/flutter/flutter_grpc</a> for a complete example project.</p>`,19),w=[c,l,u,i,r,k,d,g,m,h];function f(v,y,x,_,b,C){return t(),e("div",null,w)}var A=a(o,[["render",f]]);export{P as __pageData,A as default};
